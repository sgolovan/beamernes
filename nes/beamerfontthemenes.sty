%% beamerfontthemenes.sty --
%%
%% The New Economic School beamer font theme
%%
%% Copyright 2020-2024 Sergei Golovan
%%
%% The code is derived from the Metropolis theme,
%% Copyright 2015 Matthias Vogelgesang and the LaTeX community
%%
%% This work is licensed under a Creative Commons Attribution-ShareAlike 4.0
%% International License (https://creativecommons.org/licenses/by-sa/4.0/).
%%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerfontthemenes}[2024/05/02 New Economic School font theme]
\RequirePackage{fontspec}
\RequirePackage{unicode-math}

\addfontfeature{Numbers={Monospaced}}%

\usefonttheme{professionalfonts}
\usefonttheme{metropolis}

\setmainfont{Lato}
\setsansfont{Lato}
\setmonofont{Fira Mono}

\setmathfont{Lato Math}
% As for now Fira Math is incomplete, so add glyphs from other fonts
%\setmathfont[range={\vdots,\ddots,\bot,\top,\bigcup,\bigcap,frak}]{TeX Gyre Bonum Math}
%\setmathfont[range={cal}]{TeX Gyre DejaVu Math}
%\setmathfont[range={\setminus,frak}]{STIX Two Math}
%\setmathfont[range={"0302-"0304,\Vbar}]{GFS Neohellenic Math}
%\setmathfont[range={"0304}]{Fira Math}

\setbeamerfont{title}{size=\huge,
                      series=\normalfont,
                      family=\nes@family}
\setbeamerfont{section title}{family=\nes@family}
\setbeamerfont*{subtitle}{family=\nes@family}
\setbeamerfont{frametitle}{size=\LARGE,
                           series=\normalfont,
                           family=\nes@family}
\setbeamerfont{framesubtitle}{size=\normalsize,
                              series=\normalfont,
                              family=\nes@family}
\pgfkeys{
  /metropolis/font/titleformat font family/.cd,
    .is choice,
    auto/.code={%
      \IfFontExistsTF{Museo Sans Cyrl 300}{%
        \IfFontExistsTF{Museo Sans Cyrl 500}{%
          \let\nes@family\undefined
          \newfontfamily\nes@family{Museo Sans Cyrl 300}[BoldFont={Museo Sans Cyrl 500},%
                                                        Ligatures=TeX,%
                                                        Scale=MatchLowercase]%
        }{%
          \let\nes@museo\relax
        }%
      }{%
        \let\nes@museo\relax
      }%
    },
    lato/.code={%
      \let\nes@family\undefined
      \newfontfamily\nes@family{Lato}[Ligatures=TeX]%
    },
    segoe/.code={%
      \let\nes@family\undefined
      \newfontfamily\nes@family{Segoe UI}[Ligatures=TeX]%
    },
    museo/.code={%
      \let\nes@family\undefined
      \newfontfamily\nes@family{Museo Sans Cyrl 300}[BoldFont={Museo Sans Cyrl 500},%
                                                    Ligatures=TeX,%
                                                    Scale=MatchLowercase]%
    },
}
\pgfkeys{
  /metropolis/font/.cd,
  titleformatfontfamily/.code=\pgfkeysalso{titleformat font family=#1},
}
\newcommand{\nes@font@setdefaults}{
  \pgfkeys{/metropolis/font/.cd,
    titleformat font family=auto,
  }
}
\nes@font@setdefaults
\ProcessPgfPackageOptions{/metropolis/font}
\endinput

%% End of beamerfontthemenes.sty
