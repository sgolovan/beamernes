%% beamerfontthemenes.sty --
%%
%% The New Economic School beamer font theme
%%
%% Copyright 2020-2024 Sergei Golovan
%%
%% The code is derived from the Metropolis theme,
%% Copyright 2015 Matthias Vogelgesang and the LaTeX community
%%
%% This work is licensed under a Creative Commons Attribution-ShareAlike 4.0
%% International License (https://creativecommons.org/licenses/by-sa/4.0/).
%%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerfontthemenes}[2024/05/02 New Economic School font theme]
\RequirePackage{fontspec}
\RequirePackage{unicode-math}

%\addfontfeature{Numbers={Monospaced}}%

\usefonttheme{professionalfonts}
\usefonttheme{metropolis}

\setmainfont{Lato}
\setsansfont{Lato}
\setmonofont{Noto Sans Mono}

\RequirePackage{lete-sans-math}
% As for now Fira Math is incomplete, so add glyphs from other fonts
%\setmathfont[range={\vdots,\ddots,\bot,\top,\bigcup,\bigcap,frak}]{TeX Gyre Bonum Math}
%\setmathfont[range={cal}]{TeX Gyre DejaVu Math}
%\setmathfont[range={\setminus,frak}]{STIX Two Math}
%\setmathfont[range={"0302-"0304,\Vbar}]{GFS Neohellenic Math}
%\setmathfont[range={"0304}]{Fira Math}

\let\nes@titlefamilyauto\relax

\setbeamerfont{title}{size=\huge,
                      series=\normalfont,
                      family=\nes@family}
\setbeamerfont{section title}{family=\nes@family}
\setbeamerfont*{subtitle}{family=\nes@family}
\setbeamerfont{frametitle}{size=\LARGE,
                           series=\normalfont,
                           family=\nes@family}
\setbeamerfont{framesubtitle}{size=\normalsize,
                              series=\normalfont,
                              family=\nes@family}
\pgfkeys{
  /metropolis/font/font family/.cd,
    .is choice,
    lato/.code={%
      \setmainfont{Lato}
      \setsansfont{Lato}
      \ifx\nes@titlefamilyauto\relax
        \let\nes@family\undefined
        \newfontfamily\nes@family{Lato}[Ligatures=TeX]%
      \fi
    },
    segoe/.code={%
      \setmainfont{Segoe UI}
      \setsansfont{Segoe UI}
      \ifx\nes@titlefamilyauto\relax
        \let\nes@family\undefined
        \newfontfamily\nes@family{Segoe UI}[Ligatures=TeX]%
      \fi
    },
    museo/.code={%
      \setmainfont{Museo Sans Cyrl 300}[BoldFont={Museo Sans Cyrl 500},%
                                        Scale=MatchLowercase]%
      \setsansfont{Museo Sans Cyrl 300}[BoldFont={Museo Sans Cyrl 500},%
                                        Scale=MatchLowercase]%
      \ifx\nes@titlefamilyauto\relax
        \let\nes@family\undefined
        \newfontfamily\nes@family{Museo Sans Cyrl 300}[BoldFont={Museo Sans Cyrl 500},%
                                                       Ligatures=TeX,%
                                                       Scale=MatchLowercase]%
      \fi
    },
}
\pgfkeys{
  /metropolis/font/titleformat font family/.cd,
    .is choice,
    auto/.code={%
      \let\nes@titlefamilyauto\relax
    },
    lato/.code={%
      \let\nes@titlefamilyauto\undefined
      \let\nes@family\undefined
      \newfontfamily\nes@family{Lato}[Ligatures=TeX]%
    },
    segoe/.code={%
      \let\nes@titlefamilyauto\undefined
      \let\nes@family\undefined
      \newfontfamily\nes@family{Segoe UI}[Ligatures=TeX]%
    },
    museo/.code={%
      \let\nes@titlefamilyauto\undefined
      \let\nes@family\undefined
      \newfontfamily\nes@family{Museo Sans Cyrl 300}[BoldFont={Museo Sans Cyrl 500},%
                                                    Ligatures=TeX,%
                                                    Scale=MatchLowercase]%
    },
}
\pgfkeys{
  /metropolis/font/.cd,
  fontfamily/.code=\pgfkeysalso{font family=#1},
  titleformatfontfamily/.code=\pgfkeysalso{titleformat font family=#1},
}
\newcommand{\nes@font@setdefaults}{
  \pgfkeys{/metropolis/font/.cd,
    font family=lato,
    titleformat font family=auto,
  }
}
\nes@font@setdefaults
\ProcessPgfPackageOptions{/metropolis/font}
\endinput

%% End of beamerfontthemenes.sty
